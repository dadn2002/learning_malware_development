#include "../imports.h"

/* Information 
create .exe of .cpp using .obj data
gcc name.cpp name2.obj -o name.exe  (-o is to rename, usual output is a.exe)
to create a .obj from .asm
ml64 /c /Fo"name.obj" name.asm
*/

extern "C" PTEB getTEB(void);
extern "C" DWORD CustomError(void);

int main(void) {
    info("getting the TEB");
    PTEB pTEB = getTEB();
    okay("\\___[ TEB\n\t\\-0x%p]\n", pTEB);

    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, 5);

    if (hProcess == NULL){
        okay("[OpenProcess]  FAILED!");
        info("[CustomError]  ERROR: 0x%lx", CustomError());
        info("[GetLastError] Error: 0x%lx", GetLastError());
        if (CustomError() == GetLastError()){
            okay("value match!");
            return 0;
        }
        warn("values dont match: 0x%lx", GetLastError());
        return 1;
    }
}
