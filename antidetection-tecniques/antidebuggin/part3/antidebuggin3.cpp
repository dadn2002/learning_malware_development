#include "../../imports.h"

/* Information 
create .exe of .cpp using .obj data
gcc name.cpp name2.obj -o name.exe  (-o is to rename, usual output is a.exe)
to create a .obj from .asm
ml64 /c /Fo"name.obj" name.asm
*/

extern "C" PPEB GetPEB(void);
extern "C" BYTE CheckDebugger(void);

int main(void){

    info("getting PEB");
    PPEB pPEB = GetPEB();
    okay("\\___[ PEB\n\t\\_0x%p]", pPEB);

    if (CheckDebugger() != 0){
        info("[PEB->BeingDebugged: 0x%d]", CheckDebugger());  // or just pPEB->BeingDebugged
        warn("debugger detected!");
        return 1;
    } 

    info("[PEB->BeingDebugged: 0x%d]", CheckDebugger());
    okay("no debugger detected!");
    MessageBoxW(NULL, L"Hello", L"Whos There", MB_ICONEXCLAMATION);
    return 0;
}