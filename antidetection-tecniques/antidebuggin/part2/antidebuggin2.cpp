#include "../imports.h"

/* Information 
create .exe of .cpp using .obj data
gcc name.cpp name2.obj -o name.exe  (-o is to rename, usual output is a.exe)
*/

#ifdef _WIN64
PPEB pPEB = (PPEB)__readgsqword(0x60);   // line 3
#elif _WIN32
PPEB pPEB = (PPEB)__readfsqword(0x30);   // line 3
#endif

int main(void){
    /* here we check without calling the windows.api, but */
    /* verifing the own PEB of the executable */
    if (pPEB->BeingDebugged != 0) {
        info("program is being debugged!");
        return 1;
    }

    okay("not being debugged!");
    MessageBoxW(NULL, L"Hello", L"Whos There", MB_ICONEXCLAMATION);
    return 0;
}